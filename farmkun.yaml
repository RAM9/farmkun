{
  "ignition": {
    "version": "3.4.0"
  },
  "passwd": {
    "users": [
      {
        "groups": [
          "wheel",
          "sudo"
        ],
        "name": "core",
        "passwordHash": "$1$82024$51fV6RLyDo3oFsfkc3H7S/",
        "sshAuthorizedKeys": [
          "ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIFBQm/e9Ej4PuQuo/M2IV0/IxGAOE83oMnBCwBn2WAaP",
          "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDGyraMnjnSZiPrRZKkRixfA9qatS8EA5AD1mhRP7bRp8d2ix98lp2NvJ43hC4aEmH/PWIfPPAMVPR0URMydS65xJHvQwl/Z6ULJuYxp6Lwlfec3KfrPOy4QmKUc+hfJC3gu5U7HW6iU7s91gPGz4IO1p/XPmi0GLfWBAbqLhcvteIykQ4zlFHdjdHy07gc3IICoSvQhOgBjhAMwtkr0tWJeXIbdk70f/bOha4tr1GM493IBrtoFkK95Na7HnAw8Jj7TAIh8LqB8FWwU8zkXl0wUHN3jz5Vg6IWdINfY7OSNwmnSjWH5FHPYS85uSrodLiAIusAe2ulFtO61wTGjqVylgspVXLklF7Kpyoyf5AtoxlVMPFN0uiZqhuJ3JaBn0e0gbQvGwPQKo2ZV+dmssIvatKg3MDDURJfT/k0gIViomyzD/Ol8RIy6uCTqHV4fa5MvgCGj3Yy7oN3vNhqdbqxsfHBh3E/x+rXnNHSn27OUhVSBLe3INgPnKghnTSRyHNu7b5jwCqzWan0DY7TkGzv/JL2onFpQWFKoziQ89h5yWcOD8OOMmWJZ5r4rp3qGBkyB8e3CNxDNRobhDVU8ZG7AKz5avLAgL43pNbnYzDrTDtP/Q9EVKrLKFK0pkaNtKmRx8Dr1oXlpODWBoOHgqnV92y0au7SVzN05/RFUcyp6Q=="
        ]
      }
    ]
  },
  "storage": {
    "disks": [
      {
        "device": "/dev/disk/by-id/coreos-boot-disk",
        "partitions": [
          {
            "label": "root",
            "number": 4,
            "resize": true,
            "sizeMiB": 16384
          },
          {
            "label": "var",
            "sizeMiB": 0,
            "wipePartitionEntry": true
          }
        ],
        "wipeTable": false
      }
    ],
    "files": [
      {
        "overwrite": true,
        "path": "/etc/rancher/post-install.bash",
        "contents": {
          "compression": "gzip",
          "source": "data:;base64,H4sIAAAAAAAC/7xTS4vbMBC++1d8jQs9FFnpEzbNppRCSmBJod1bKUWWx2thWQojOSH/vsjetHlB6WUvttHMfPM95PyZLI2T5LYoVWiyHKQCwdfoA2VDzTqIALlVLK0pJSunG2LJLb0e6m1fko4Wsg8srdfKHh9fQ+zayjDEBpK9j7JIrSe7KOrTPelR7FVnj0ek9q42D1mWQ1tSjA0bzxhPe1bReJdxB8H1KaTzFV0tpDXnFC/qWQ5TQ9s+RGKYAGWZVLUH984Z9wATsTPWgilsvKuwM7GBVpo4hiyHchViYwJMcC8iYkOoDYeITunGuEcndM8Wom7RxLgJMylrxV3bu4JVd1NoPbt58/adPKCaGj/w/CNubzHFzw8J1GVADvfy1QE3ZMAYtm48JovFYoGl712Fb4/El+MKzOfz+eTQPRL5y2O0t9iw2ap4yGDMRvgr0R01DIxW6+/3n+7u8Pnrern68mdL0/kK76fTfyCQDTTAlOlSae8qk2KGOPPwUuraX+isB/Uz3Kc0vKMxtpK07w6ZpKuC/zJkmPv1xLbUJjvTu4LqkO5M6SMEAsWYpKdJEYi3xJNxJOxDpC79wORUaem4pUgvo+m8M0TFEUI4L0rrdTt87q5O/g4AAP//sp4dXWEEAAA="
        },
        "mode": 484
      },
      {
        "overwrite": true,
        "path": "/etc/rancher/install.sh",
        "contents": {
          "source": "https://get.rke2.io"
        }
      },
      {
        "overwrite": true,
        "path": "/etc/profile.d/zzz-default-editor.sh",
        "contents": {
          "compression": "",
          "source": "data:,export%20EDITOR%3Dvim%0A"
        }
      }
    ],
    "filesystems": [
      {
        "device": "/dev/disk/by-partlabel/var",
        "format": "ext4",
        "path": "/var",
        "wipeFilesystem": true
      }
    ]
  },
  "systemd": {
    "units": [
      {
        "contents": "# Generated by Butane\n[Unit]\nRequires=systemd-fsck@dev-disk-by\\x2dpartlabel-var.service\nAfter=systemd-fsck@dev-disk-by\\x2dpartlabel-var.service\n\n[Mount]\nWhere=/var\nWhat=/dev/disk/by-partlabel/var\nType=ext4\n\n[Install]\nRequiredBy=local-fs.target",
        "enabled": true,
        "name": "var.mount"
      },
      {
        "contents": "[Unit]\nDescription=Install Rancher2 Via Tar\nWants=network-online.target\nAfter=network-online.target\nBefore=zincati.service\nConditionPathExists=!/var/lib/%N.stamp\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nExecStart=/bin/sh /etc/rancher/install.sh\nExecStart=/bin/touch /var/lib/%N.stamp\n\n[Install]\nWantedBy=multi-user.target\n",
        "enabled": true,
        "name": "install-rancher2-tar.service"
      },
      {
        "contents": "[Unit]\nDescription=Run Rancher Kubernetes according to machine role\nWants=network-online.target\nAfter=install-rancher2-tar.service\nBefore=zincati.service\n[Service]\nExecStart=/bin/bash /etc/rancher/post-install.bash\n[Install]\nWantedBy=multi-user.target\n",
        "enabled": true,
        "name": "farm.ram9.cc.service"
      },
      {
        "contents": "[Unit]\nDescription=Layer vim with rpm-ostree\nWants=network-online.target\nAfter=install-rancher2-tar.service\n# We run before `zincati.service` to avoid conflicting rpm-ostree\n# transactions.\nBefore=zincati.service\nConditionPathExists=!/var/lib/%N.stamp\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nExecStart=/usr/bin/rpm-ostree install -y --allow-inactive vim tmux emacs zsh NetworkManager-wifi  iwlwifi-dvm-firmware iwlwifi-mvm-firmware\nExecStart=/bin/touch /var/lib/%N.stamp\nExecStart=/bin/systemctl --no-block reboot\n\n[Install]\nWantedBy=multi-user.target\n",
        "enabled": true,
        "name": "rpm-ostree-install-packages.service"
      }
    ]
  }
}
